{"version":3,"sources":["uni-app:///main.js","webpack:///C:/code/uniapp/uniapp-novel/pages/collection/collection.vue?26dd","webpack:///C:/code/uniapp/uniapp-novel/pages/collection/collection.vue?21ad","webpack:///C:/code/uniapp/uniapp-novel/pages/collection/collection.vue?c516","webpack:///C:/code/uniapp/uniapp-novel/pages/collection/collection.vue?b260","uni-app:///pages/collection/collection.vue"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","tabTop","searchBox","collectItem","uniPopup","data","calHeight","tabIndex","showCancelStatus","tabList","statusBarHeight","cancelId","books","histroy","page","loadText","mounted","$u","pageID","pos","isTabBarPage","success","onShow","methods","getData","getHistroyData","scrolltolower","swiperTabIndex","changeTabIndex","getId","showCancel","bol","getIdIndex","cancelCollect","uni","title","icon","key","toBookDetail","url","changePopupStatus","watch","animation"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,mBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAuH;AACvH;AAC8D;AACL;;;AAGzD;AACwM;AACxM,gBAAgB,+MAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,qFAAM;AACR,EAAE,8FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,yFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,8LAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AClDA;AAAA;AAAA;AAAA;AAAgyB,CAAgB,8xBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;AC0DpzB;AAEA;AAGA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IAAA;IACAC;MACAC;MACAC;MACAC;MACAC;QAAA;MAAA;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACAC;MAAA;MACA;QACA;QACA;UACA;QACA;UACA;UAEA;QACA;MACA;QACA;UACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACA;IACAC;MACA;MACAC;IACA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACA;IACAC;MAAA;MAGA;QACA;UACA;UACAC;YACAC;YACAC;UACA;UACA;UACA;UACA;QACA;MACA;QACA;UAAA;QAAA;QACA;QACA;QACAF;UACAG;UACAhC;QACA;QACA6B;UACAC;UACAC;QACA;QACA;MACA;IAIA;IACAE;MACA;MACA;QACAJ;UACAK;QACA;MACA;IACA;IACA;IACAC;MACA;IACA;EAEA;EACAC;IACAjC;MACA;QACA0B;UACAQ;QACA;MACA;QACAR;UACAQ;QACA;MACA;IACA;EACA;AACA;AAAA,2B","file":"pages/collection/collection.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/collection/collection.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./collection.vue?vue&type=template&id=74d0bef4&\"\nvar renderjs\nimport script from \"./collection.vue?vue&type=script&lang=js&\"\nexport * from \"./collection.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/collection/collection.vue\"\nexport default component.exports","export * from \"-!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collection.vue?vue&type=template&id=74d0bef4&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.books.length\n  var g1 = !(g0 == 0)\n    ? _vm.books.length > 10 || _vm.loadText == \"没有更多了\"\n    : null\n  var g2 = _vm.histroy.length\n  var g3 = !(g2 == 0) ? _vm.histroy.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collection.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../codesoft/HBuilderX.3.8.4.20230531/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./collection.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view class=\"cal\" :style=\"{height: `${statusBarHeight}px`}\"></view>\r\n\t\t<search-box class=\"cal\"></search-box>\r\n\t\t<tab-top :tabArr=\"tabList\" :tabIndex=\"tabIndex\" @changeTabIndex=\"changeTabIndex\" class=\"cal\">\r\n\t\t</tab-top>\r\n\t\t<swiper :current=\"tabIndex\" @change=\"swiperTabIndex\" :style=\"{height:`${calHeight}rpx`}\">\r\n\t\t\t<swiper-item>\r\n\t\t\t\t<scroll-view scroll-y=\"true\" :style=\"{height: `${calHeight}rpx`}\" @scrolltolower=\"scrolltolower(tabI)\">\r\n\t\t\t\t\t<collect-item v-for=\"(item,index) in books\" :item=\"item\" :key=\"item.id\" @getId=\"getId\"\r\n\t\t\t\t\t\t@showCancel=\"showCancel\" @toDetail=\"toBookDetail\"></collect-item>\r\n\t\t\t\t\t<view v-if=\"books.length == 0\" class=\"flex align-center justify-center text-secondary font\"\r\n\t\t\t\t\t\tstyle=\"height: 200rpx;\">\r\n\t\t\t\t\t\t暂无收藏内容\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else-if=\"books.length > 10 || loadText == '没有更多了'\"\r\n\t\t\t\t\t\tclass=\"flex align-center justify-center font text-light-muted \" style=\"height: 80rpx;\">\r\n\t\t\t\t\t\t{{loadText}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</swiper-item>\r\n\t\t\t<swiper-item>\r\n\t\t\t\t<scroll-view scroll-y=\"true\" :style=\"{height: `${calHeight}rpx`}\">\r\n\t\t\t\t\t<collect-item v-for=\"(item,index) in histroy\" :item=\"item\" :key=\"item.id\" @getId=\"getId\"\r\n\t\t\t\t\t\t@showCancel=\"showCancel\" @toDetail=\"toBookDetail\"></collect-item>\r\n\t\t\t\t\t<view v-if=\"histroy.length == 0\" class=\"flex align-center justify-center text-secondary font\"\r\n\t\t\t\t\t\tstyle=\"height: 200rpx;\">\r\n\t\t\t\t\t\t暂无历史记录\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view v-else-if=\"histroy.length > 0\" class=\"flex align-center justify-center font text-light-muted \"\r\n\t\t\t\t\t\tstyle=\"height: 80rpx;\">\r\n\t\t\t\t\t\t没有更多了\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\r\n\r\n\t\t<uni-popup ref=\"popup\" type=\"bottom\" @change=\"changePopupStatus\">\r\n\t\t\t<view class=\"bg-white\">\r\n\t\t\t\t<view class=\"flex align-center\" style=\"height: 100rpx;\" @click=\"cancelCollect\">\r\n\t\t\t\t\t<iconfont iconId=\"icon-xingxing\" iconColor=\"text-danger\" class=\"px-3\"></iconfont>\r\n\t\t\t\t\t<text class=\"font\">{{tabIndex == 0 ? '取消收藏' : '删除记录'}}</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"bg-hover-light\" style=\"height: 15rpx;\"></view>\r\n\t\t\t\t<view class=\"text-center\" style=\"height: 110rpx;line-height: 110rpx;\" @click=\"showCancel(false)\">\r\n\t\t\t\t\t取消\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport tabTop from '@/components/tab-top.vue'\r\n\timport searchBox from '@/components/search-box.vue'\r\n\timport collectItem from '@/components/collect-item.vue'\r\n\timport uniPopup from '@/components/uni-popup/uni-popup.vue'\r\n\r\n\timport $u from '@/common/unit.js';\r\n\r\n\timport {\r\n\t\tuncollect,\r\n\t\tgetCollectList\r\n\t} from '@/api/collection.js'\r\n\r\n\texport default {\r\n\t\tcomponents: {\r\n\t\t\ttabTop,\r\n\t\t\tsearchBox,\r\n\t\t\tcollectItem,\r\n\t\t\tuniPopup\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tcalHeight: 0,\r\n\t\t\t\ttabIndex: 0,\r\n\t\t\t\tshowCancelStatus: false,\r\n\t\t\t\ttabList: ['我的收藏', '历史记录'],\r\n\t\t\t\tstatusBarHeight: this.$statusBarHeight,\r\n\t\t\t\tcancelId: 0,\r\n\t\t\t\tbooks: [],\r\n\t\t\t\thistroy: [],\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tloadText: '没有更多了',\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t$u.calSurplusHeight({\r\n\t\t\t\tpageID: this,\r\n\t\t\t\tpos: 'cal',\r\n\t\t\t\tisTabBarPage: true,\r\n\t\t\t\tsuccess: val => this.calHeight = val\r\n\t\t\t})\r\n\t\t},\r\n\t\tonShow() {\r\n\t\t\tthis.getData();\r\n\t\t\tthis.getHistroyData();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetData() {\r\n\t\t\t\tgetCollectList(this.page).then(res => {\r\n\t\t\t\t\t// console.log(res);\r\n\t\t\t\t\tif (this.page == 1) {\r\n\t\t\t\t\t\tthis.books = res.data.list;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.books = [...this.books, ...res.data.list];\r\n\r\n\t\t\t\t\t\tthis.loadText = res.data.list.length >= 10 ? '上拉加载更多' : '没有更多了'\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tif (this.page > 1) {\r\n\t\t\t\t\t\tthis.page--;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.loadText = '上拉加载更多';\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tgetHistroyData() {\r\n\t\t\t\tlet list = uni.getStorageSync('histroy');\r\n\t\t\t\tthis.histroy = list ? JSON.parse(list) : [];\r\n\t\t\t},\r\n\t\t\tscrolltolower() {\r\n\t\t\t\tthis.page++;\r\n\t\t\t\tthis.getData();\r\n\t\t\t},\r\n\t\t\tswiperTabIndex(e) {\r\n\t\t\t\tthis.tabIndex = e.detail.current;\r\n\t\t\t},\r\n\t\t\t// 获取tabIndex\r\n\t\t\tchangeTabIndex(tabIndex) {\r\n\t\t\t\tthis.tabIndex = tabIndex\r\n\t\t\t},\r\n\t\t\t// 拿到目标id\r\n\t\t\tgetId(id) {\r\n\t\t\t\t// console.log(id);\r\n\t\t\t\tthis.cancelId = id;\r\n\t\t\t},\r\n\t\t\t// 打开取消收藏选项\r\n\t\t\tshowCancel(bol) {\r\n\t\t\t\t// console.log(bol);\r\n\t\t\t\tbol ? this.$refs.popup.open() : this.$refs.popup.close();\r\n\t\t\t},\r\n\t\t\t// 根据id获取index\r\n\t\t\tgetIdIndex(id) {\r\n\t\t\t\treturn this.books.findIndex(item => item.id == id);\r\n\t\t\t},\r\n\t\t\t// 删除收藏\r\n\t\t\tcancelCollect(type) {\r\n\r\n\r\n\t\t\t\tif (this.tabIndex == 0) {\r\n\t\t\t\t\tuncollect(this.cancelId).then(res => {\r\n\t\t\t\t\t\t// console.log(res);\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '取消收藏成功',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tlet index = this.getIdIndex(this.cancelId);\r\n\t\t\t\t\t\tthis.books.splice(index, 1);\r\n\t\t\t\t\t\tthis.showCancel(false);\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet index = this.histroy.findIndex(item => item.id == this.cancelId);\r\n\t\t\t\t\tthis.histroy.splice(index, 1);\r\n\t\t\t\t\t// 删除后存储历史记录\r\n\t\t\t\t\tuni.setStorage({\r\n\t\t\t\t\t\tkey: 'histroy',\r\n\t\t\t\t\t\tdata: JSON.stringify(this.histroy),\r\n\t\t\t\t\t})\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"删除成功\",\r\n\t\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.showCancel(false);\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t},\r\n\t\t\ttoBookDetail(id) {\r\n\t\t\t\t// console.log(id);\r\n\t\t\t\tif (id !== 0) {\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: \"/pages/book-detail/book-detail?id=\" + id,\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 监听改变显示状态\r\n\t\t\tchangePopupStatus(e) {\r\n\t\t\t\tthis.showCancelStatus = e.show;\r\n\t\t\t},\r\n\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tshowCancelStatus(newVal) {\r\n\t\t\t\tif (newVal) {\r\n\t\t\t\t\tuni.hideTabBar({\r\n\t\t\t\t\t\tanimation: true,\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showTabBar({\r\n\t\t\t\t\t\tanimation: true,\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"sourceRoot":""}